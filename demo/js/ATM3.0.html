<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <script>
        /*
         完成ATM的综合练习
         a)完成登录、注册、修改密码功能
         b)完成查询余额和存取,选做转账功能
         c)大致流程：
             i.用户需要先输入一级菜单选项：1.登录 2. 注册 3. 退出
                 1.注册：输入用户名和密码，不允许重复注册相同的用户名。注册的用户和密码需要追加到二维数组中。
                 var users=[["admin","ad123"]] 其中admin是用户名，ad123是密码
                 2.登录：遍历用户和密码数组，并进行验证。
             ii.只能登录成功才能进入二级菜单
                 1. 查询 2. 存钱 3. 取钱 4. 转账 5. 修改密码 6. 返回上一步
         
         流程：
         1. 提示一级菜单并让用户输入选项
         2. 执行所选选项的对应功能
             登录 注册  退出 --- switch
             登录：遍历数组，判断是否输对
             注册：将用户输入的用户名和密码追加到数组中，需要考虑不能重复注册
             退出：提示就结束程序
     */

        let saveUsers = [];
        let isGo = true;
        let loginUser = null;
        while (isGo) {
            let operate = prompt("请选择一级菜单选项：1.登录 2. 注册 3. 退出") - 0;
            switch (operate) {
                case 1://登录
                    if (saveUsers.length == 0) {
                        alert("请注册账户")
                    } else {
                        let loginName = prompt("请输入登录用户名");
                        let loginPassword = prompt("请输入登录密码");
                        let isLogin = false;//默认登录失败
                        for (let i = 0; i < saveUsers.length; i++) {
                            if (loginName == saveUsers[i][0] && loginPassword == saveUsers[i][1]) {
                                isLogin = true;
                                loginUser = saveUsers[i];
                                break;
                            }
                        }
                        if (isLogin) {
                            alert("登录成功")
                            let isGo2 = true;
                            while (isGo2) {
                                let operate2 = prompt("请选择二级菜单选项：1. 查询 2. 存钱 3. 取钱 4. 转账 5. 修改密码 6. 返回上一步") - 0;
                                switch (operate2) {
                                    case 1://查询
                                        if (loginUser[2] != undefined) {

                                            alert(`余额还剩${loginUser[2]}`)
                                        } else {
                                            alert("余额为0")
                                        }

                                        break;

                                    case 2://存钱
                                        let saveMoney = prompt("请输入存钱金额") - 0;
                                        if (saveMoney % 100 == 0 && saveMoney > 0) {
                                            loginUser[2] = (loginUser[2] || 0) + saveMoney;
                                            alert(`余额还剩${loginUser[2]}`)
                                        } else {
                                            alert("存钱金额错误，请重新输入");
                                        }
                                        break;

                                    case 3://取钱
                                        let deductMoney = prompt("请输入取钱金额") - 0;
                                        if (deductMoney % 100 == 0 && deductMoney > 0) {
                                            if (deductMoney > loginUser[2]) {
                                                alert("余额不足")
                                            } else {
                                                loginUser[2] = loginUser[2] - deductMoney;
                                                alert(`余额还剩${loginUser[2]}`)
                                            }

                                        } else {
                                            alert("取钱金额错误，请重新输入");
                                        }

                                        break;

                                    case 4://转账
                                        let convertToUserName = prompt("请输入要转账的账户名");
                                        if (convertToUserName != loginName) {
                                            for (let i = 0; i < saveUsers.length; i++) {
                                                if (convertToUserName == saveUsers[i][0]) {
                                                    let convertToMoney = prompt("请输入转账的金额") - 0;
                                                    loginUser[2] = loginUser[2] - convertToMoney;
                                                    saveUsers[i][2] = (saveUsers[i][2] || 0) + convertToMoney;
                                                    alert(`余额还剩${loginUser[2]}`)
                                                    break;
                                                }
                                            }
                                        } else {
                                            alert("请不要给自己转账")
                                        }


                                        break;

                                    case 5://修改密码

                                        break;

                                    case 6://返回上一级菜单
                                        isGo2 = false;
                                        break;
                                        
                                    default:
                                        alert("指令无效，请重新输入");
                                        break;
                                }

                            }


                        } else {
                            alert("登录失败")
                        }

                    }

                    break;
                case 2://注册
                    let registerName = prompt("请输入注册用户名");
                    let registerPassword = prompt("请输入注册密码");
                    if (saveUsers == 0) {
                        saveUsers.push([registerName, registerPassword]);
                    } else {
                        let isHave = false;//默认不重复
                        for (let i = 0; i < saveUsers.length; i++) {
                            if (registerName == saveUsers[i][0]) {
                                isHave = true;//表示用户名重复了
                                break;
                            }
                        }
                        if (isHave) {
                            alert("用户名重复，注册失败")
                        } else {
                            alert("注册成功")
                            saveUsers.push([registerName, registerPassword])
                        }
                    }
                    alert(saveUsers)
                    break;
                case 3://退出
                    isGo = false;
                    break;

                default:
                    alert("指令无效，请重新输入");
                    break;
            }

        }
    </script>
</body>

</html>