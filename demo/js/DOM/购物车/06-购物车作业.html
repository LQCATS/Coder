<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Document</title>
  <style>
    img {
      width: 100px;
    }

    input {
      width: 30px;
    }

    td {
      text-align: center;
    }

    .totalPrice {
      text-align: right;
    }

    .todel {
      width: 30px;
    }
  </style>
</head>

<body>
  <button>添加</button>
  <button>删除所有</button>

  <table border="1">
    <thead>
      <tr>
        <th>选择</th>
        <th>名称</th>
        <th>图片</th>
        <th>单价</th>
        <th>操作</th>
        <th>总价</th>
      </tr>
    </thead>
    <tbody>
      <!-- <tr>
        <td><input type="checkbox" class="todel"></td>
        <td>卫龙辣条1</td>
        <td><img src="img/banner1.jpg" alt="" /></td>
        <td>3.5</td>
        <td>
          <button class="sub">-</button>
          <span>1</span>
          <button class="add">+</button>
          <button class="del">删除</button>
        </td>
        <td>0</td>
      </tr> -->

    </tbody>
    <tfoot>
      <tr>
        <!-- 总价格 -->
        <td><input type="checkbox" class="todelall"> <span>全选</span></td>
        <td colspan="5" class="totalPrice">0</td>
      </tr>
    </tfoot>
  </table>

  <script>
    /*
      使用DOM来操作HTML页面完成购物车相关功能
        1. 构建数据完成页面的数据渲染
        2. 计算单件商品的总价
        3. 计算所有商品的总价
        4. 实现数量增加和减少
        5. 刪除当前的商品
    */
    let carProducts = [
      { id: 1, name: "酸菜凤爪", price: 3.5, num: 5, imgSrc: "img/banner1.jpg" },
      { id: 2, name: "杨梅干", price: 5.5, num: 1, imgSrc: "img/banner2.jpg" },
      { id: 3, name: "坚果大礼包", price: 73.5, num: 2, imgSrc: "img/banner3.jpg" },
      { id: 4, name: "广味香肠", price: 13.5, num: 3, imgSrc: "img/banner4.jpg" }

    ];

    let tbodyEle = document.querySelector("tbody");
    let totalPriceEle = document.querySelector(".totalPrice");

    /**
     * 主函数
     */
    function main() {
      reader(carProducts);
      changeGoodsNum();
      delGoods();
    };
    main();

/**
 * 渲染函数
 */
function reader(arr) {
//定义一个变量接受所有商品的总价格
let sum = 0;
arr.forEach(value => {
  //新建一个tr标签
  let newTr = document.createElement("tr");
  //填充tr标签内容
  newTr.innerHTML =
    `<td><input type="checkbox" class="todel"></td>
    <td>${value.name}</td>
    <td><img src=${value.imgSrc} alt="" /></td>
    <td>${value.price}</td>
    <td>
      <button class="sub">-</button>
      <span>${value.num}</span>
      <button class="add">+</button>
      <button class="del">删除</button>
    </td>
    <td>${value.num * value.price}</td>`
  //将tr插入tbody的最后一个节点
  tbodyEle.appendChild(newTr);
  sum += value.num * value.price;
});
//将总价格渲染到页面上
totalPriceEle.innerText = sum;
};

/**
 * 商品数量增减函数
 */
function changeGoodsNum() {
  //span标签类数组
  tbodyEle.addEventListener("click", function (event) {
    let subEle = event.target;
    let spanEle = event.target.nextElementSibling;
    let spanEleNum = spanEle.innerText - 0;
    if (subEle.className === "sub" && spanEleNum > 0) {
      spanEleNum--
    } else if (subEle.className === "add") {
      spanEleNum++
    }
  })
  
};

  /**
   * 删除商品函数
   */
  function delGoods() {
    tbodyEle.addEventListener("click", function (event) {
      if (event.target.className === "del") {
        event.target.parentElement.parentElement.remove()
      }
    });
  };
  
  </script>
</body>

</html>